---
import "../styles/global.css";
const { brandName } = Astro.props;

const currentPath = Astro.url.pathname;

// Simple helper to check if a link is active. 
// Using a strict check to ensure no random issues (home should only have "/" for example)
const isActive = (path) => currentPath === path;

const navLinks = [
	{ name: "home.", href: "/" },
	{ name: "about me.", href: "/about" },
	{ name: "talks.", href: "/talks" },
	{ name: "projects.", href: "/projects" },
];

// --- Styling Factory (DO NOT TOUCH IT TOOK ME HOURS TO FIGURE THIS OUT PLEASE JUST DON'T) --- 
// Here lie the desktop styles
const deskBase = "inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors";
const deskActive = "border-brand text-text-main"; 
const deskInactive = "border-transparent text-text-muted hover:border-brand-light hover:text-text-main";

// Here lie the mobile styles
const mobBase = "block pl-3 pr-4 py-2 border-l-4 text-base font-medium";
const mobActive = "bg-brand-light/10 border-brand text-brand-light";
const mobInactive = "border-transparent text-text-muted hover:bg-text-main/10 hover:border-brand-light hover:text-text-main";
---

<nav class="sticky top-0 z-50 w-full transition-colors duration-300 bg-bg-muted/80 backdrop-blur-md border-b border-text-muted/20">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="flex justify-between items-center h-16">
			<div class="flex items-center">
				<div class="flex-shrink-0 flex items-center">
					<img
						src="/favicon_custom.svg"
						alt="Page Logo"
						class="w-10 h-10" />
					<span class="ml-2 text-xl font-bold text-text-main whitespace-nowrap">{brandName}</span>
				</div>
				<!-- Desktop Specific-->
				<div class="hidden md:ml-10 md:flex md:space-x-8">
					{navLinks.map(link => (
						<a 
							href={link.href} 
							class:list={[
								deskBase, 
								isActive(link.href) ? deskActive : deskInactive
							]}
						>
							{link.name}
						</a>
					))}
				</div>
			</div>

			<div class="flex items-center md:hidden">
				<button id="hamburger-button" type="button" aria-expanded="false" aria-controls="mobile-menu" class="inline-flex items-center justify-center p-2 rounded-md text-text-muted hover:bg-text-main/10 focus:outline-none">
					<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
					</svg>
				</button>
			</div>
		</div>
	</div>
	
	<!-- --- Mobile Menu --- -->
	<div id="mobile-menu" class="hidden md:hidden">
		<div class="pt-2 pb-3 space-y-1 bg-bg-muted/95 backdrop-blur-md border-t border-text-muted/20 shadow-xl"></div>
			{navLinks.map(link => (
				<a 
					href={link.href} 
					class:list={[
					mobBase, 
					isActive(link.href) ? mobActive : mobInactive
					]}
				>
					{link.name}
				</a>
			))}
		</div>
	</div>

	<script>
		const setup = () => {
			const btn = document.getElementById('hamburger-button');
			const menu = document.getElementById('mobile-menu');
			if (btn && menu) {
				btn.onclick = () => {
					const expanded = btn.getAttribute('aria-expanded') === 'true';
					btn.setAttribute('aria-expanded', String(!expanded));
					menu.classList.toggle('hidden');
				};
			}
		};
		setup();
		document.addEventListener('astro:after-swap', setup);
	</script>
</nav>

<!-- <nav class="navbar">
		<a href="/" class="logo">{brandName}</a>

		<ul class="nav-links">
				<li><a href="/home">Home</a></li>
				<li><a href="/talks">Talks</a></li>
				<li><a href="/about">About Me</a></li>
		</ul>
</nav> -->